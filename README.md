# Приложение для создания отчетов 

Это веб-приложение на Python, разработанное с использованием Streamlit для пользовательского интерфейса и SQLite для хранения данных. Приложение предназначено для создания, управления и экспорта отчетов, а также для ведения связанных справочников и управления пользователями.

## Функционал

*   **Аутентификация пользователей:** Система входа с предопределенными учетными данными (`admin`/`admin`).
*   **Управление пользователями:**
    *   Добавление, редактирование и удаление пользователей.
    *   Управление ролями пользователей.
*   **Управление ролями:**
    *   Добавление и удаление ролей (системные роли защищены от удаления).
*   **Ведение справочников:**
    *   Управление организациями (добавление, редактирование, удаление).
    *   Управление исполнителями (добавление, редактирование, удаление).
    *   Управление руководителями проектов (добавление, редактирование, удаление).
*   **Формирование отчетов:**
    *   Создание отчетов на основе данных из справочников и заданного периода.
    *   Экспорт отчетов в формате PDF.
*   **Просмотр существующих отчетов:**
    *   Отображение списка сформированных отчетов.
    *   Возможность скачивания и удаления отчетов.
*   **Удобный пользовательский интерфейс:**
    *   Боковое меню для навигации с разделителями и сгруппированными элементами.
    *   Интуитивно понятные формы для добавления и редактирования данных.

## Структура проекта

*   `app.py`: Главный файл приложения Streamlit, инициализирует базу данных и управляет навигацией по страницам.
*   `database.py`: Модуль для взаимодействия с базой данных SQLite, содержит все CRUD-операции для пользователей, ролей, организаций, исполнителей, руководителей проектов и отчетов.
*   `ui.py`: Модуль, содержащий функции для отображения различных страниц пользовательского интерфейса Streamlit (вход, главная страница, управление пользователями, ролями и справочниками, формирование отчетов).
*   `report_generator.py`: Модуль, содержащий логику генерации PDF-отчетов с использованием библиотеки `fpdf`.
*   `fonts/`: Директория для хранения файлов шрифтов (`.ttf`, `.pkl` кэш), используемых для генерации PDF.
*   `images/`: Директория для хранения изображений (логотипы, иконки и т.д.).
*   `templates/`: Директория для хранения шаблонов PDF.
*   `report.db`: Файл базы данных SQLite (будет создан автоматически при первом запуске).
*   `requirements.txt`: Список зависимостей Python для проекта.
*   `.gitignore`: Файл для игнорирования ненужных файлов Git и Docker.
*   `Dockerfile`: Определение образа Docker для приложения.
*   `docker-compose.yml`: Конфигурация Docker Compose для запуска приложения.

## Установка и запуск (без Docker)

### Предварительные требования

*   Python 3.13
*   Git (для клонирования репозитория, если применимо)

### Шаги по установке

1.  **Клонируйте репозиторий (если вы еще этого не сделали):**
    ```bash
    git clone <URL_ВАШЕГО_РЕПОЗИТОРИЯ>
    cd Report
    ```
    (Замените `<URL_ВАШЕГО_РЕПОЗИТОРИЯ>` на актуальный URL)

2.  **Создайте и активируйте виртуальное окружение:**
    ```bash
    python -m venv .venv
    # Для Windows:
    .venv\Scripts\activate
    # Для macOS/Linux:
    source .venv/bin/activate
    ```

3.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

### Запуск приложения

1.  Убедитесь, что виртуальное окружение активировано.
2.  Запустите приложение Streamlit:
    ```bash
    streamlit run app.py
    ```

Приложение откроется в вашем веб-браузере по умолчанию.

## Развертывание с использованием Docker

### Предварительные требования

*   Установленный [Docker Desktop](https://www.docker.com/products/docker-desktop/) (включает Docker Engine и Docker Compose)

### Шаги по развертыванию

1.  **Перейдите в корневую директорию проекта:**
    Откройте терминал (командную строку) и перейдите в директорию `Report`, где находятся файлы `Dockerfile` и `docker-compose.yml`.

2.  **Соберите и запустите контейнеры:**
    Выполните следующую команду для сборки образа Docker и запуска контейнера:
    ```bash
    docker-compose up --build
    ```
    Эта команда:
    *   Соберет Docker-образ на основе `Dockerfile` (если образ еще не создан или были изменения).
    *   Создаст и запустит контейнер `web` согласно конфигурации в `docker-compose.yml`.

3.  **Доступ к приложению:**
    После успешного запуска в терминале вы увидите сообщение от Streamlit, указывающее URL-адрес. Приложение будет доступно по адресу:
    ```
    http://localhost:8501
    ```
    Откройте этот адрес в вашем веб-браузере.

### Полезные команды Docker Compose

*   **Остановить контейнеры:**
    ```bash
    docker-compose down
    ```
    Эта команда остановит и удалит контейнеры, определенные в `docker-compose.yml`.

*   **Просмотр логов контейнера:**
    ```bash
    docker-compose logs -f web
    ```
    Позволяет просматривать логи приложения в реальном времени (для сервиса `web`).

*   **Пересборка и перезапуск контейнеров (например, после изменения кода):**
    ```bash
    docker-compose up --build --force-recreate
    ```
    Эта команда пересобирает образ и создает новые контейнеры, что полезно после внесения изменений в код или `requirements.txt`.

## Учетные данные по умолчанию

При первом запуске база данных `report.db` будет инициализирована, и будет создан пользователь `admin` со следующими учетными данными:

*   **Логин:** `admin`
*   **Пароль:** `admin`

Вы можете использовать эти данные для входа в систему и дальнейшего управления пользователями, ролями и справочниками. 